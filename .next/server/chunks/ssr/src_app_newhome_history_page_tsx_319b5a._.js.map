{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/src/app/newhome/history/page.tsx"],"sourcesContent":["'use client'\r\nimport React, { useEffect, useState } from \"react\";\r\nimport \"./page.css\";\r\n\r\nconst ScheduledCapsulesPage: React.FC = () => {\r\n  const [logs, setLogs] = useState<any[]>([]);\r\n  const [receivedCapsules, setReceivedCapsules] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchLogs = async () => {\r\n      try {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        const storedUser = localStorage.getItem(\"user\");\r\n        const username = storedUser ? JSON.parse(storedUser).username : null;\r\n\r\n        if (!username) {\r\n          setError(\"No logged-in user found.\");\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Fetch the audit logs directly with the username\r\n        const logsResponse = await fetch(`/api/audit-logs?username=${username}`);\r\n        if (!logsResponse.ok) {\r\n          setError(\"Failed to fetch logs.\");\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        const data = await logsResponse.json();\r\n        setLogs(data.logs);\r\n        setReceivedCapsules(data.receivedCapsules);\r\n      } catch (error) {\r\n        console.error(\"Error fetching logs:\", error);\r\n        setError(\"An unexpected error occurred.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchLogs();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return <p>Loading...</p>;\r\n  }\r\n\r\n  if (error) {\r\n    return <p>Error: {error}</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"scheduled-container\">\r\n      <main className=\"scheduled-main\">\r\n        <h1>Capsules History</h1>\r\n        <p>Total Entries: <strong>{logs.length + receivedCapsules.length}</strong></p>\r\n        <div className=\"capsules-columns\">\r\n          {/* Created Capsules */}\r\n          <div className=\"column\">\r\n            <h2>Created Capsules</h2>\r\n            {logs.map((log) => (\r\n              <div key={log.log_id} className=\"capsule-item\">\r\n                <img\r\n                  src={`/assets/capsule.png`}\r\n                  className=\"capsule-image\"\r\n                />\r\n                <div className=\"capsule-info\">\r\n                  <p>\r\n                    Capsule Name: <strong>{log.capsule_name}</strong>\r\n                  </p>\r\n                  <p>\r\n                    Action: <strong>{log.action_type}</strong>\r\n                  </p>\r\n                  <p>\r\n                    Timestamp: <strong>{new Date(log.timestamp).toLocaleString()}</strong>\r\n                  </p>\r\n                  {log.shared_usernames && (\r\n                    <p>\r\n                      Shared With: <strong>{log.shared_usernames}</strong>\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Received Capsules */}\r\n          <div className=\"column\">\r\n            <h2>Received Capsules</h2>\r\n            {receivedCapsules.map((capsule) => (\r\n              <div key={capsule.received_id} className=\"capsule-item\">\r\n                <img\r\n                  src={`/assets/capsule.png`}\r\n                  className=\"capsule-image\"\r\n                />\r\n                <div className=\"capsule-info\">\r\n                  <p>\r\n                    Capsule Name: <strong>{capsule.capsule_name}</strong>\r\n                  </p>\r\n                  <p>\r\n                    Shared By: <strong>{capsule.shared_by_username}</strong>\r\n                  </p>\r\n                  <p>\r\n                    Received At: <strong>{new Date(capsule.received_at).toLocaleString()}</strong>\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScheduledCapsulesPage;\r\n"],"names":[],"mappings":";;;;AACA;AADA;;;;AAIA,MAAM,wBAAkC;IACtC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,EAAE;IAC1C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,EAAE;IAClE,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAElD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,YAAY;YAChB,IAAI;gBACF,wCAAmC;;gBAEnC,MAAM;gBACN,MAAM;gBAQN,kDAAkD;gBAClD,MAAM;gBAON,MAAM;YAGR,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wBAAwB;gBACtC,SAAS;YACX,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBAAO,8OAAC;sBAAE;;;;;;IACZ;IAEA,IAAI,OAAO;QACT,qBAAO,8OAAC;;gBAAE;gBAAQ;;;;;;;IACpB;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAK,WAAU;;8BACd,8OAAC;8BAAG;;;;;;8BACJ,8OAAC;;wBAAE;sCAAe,8OAAC;sCAAQ,KAAK,MAAM,GAAG,iBAAiB,MAAM;;;;;;;;;;;;8BAChE,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;8CAAG;;;;;;gCACH,KAAK,GAAG,CAAC,CAAC,oBACT,8OAAC;wCAAqB,WAAU;;0DAC9B,8OAAC;gDACC,KAAK,CAAC,mBAAmB,CAAC;gDAC1B,WAAU;;;;;;0DAEZ,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;;4DAAE;0EACa,8OAAC;0EAAQ,IAAI,YAAY;;;;;;;;;;;;kEAEzC,8OAAC;;4DAAE;0EACO,8OAAC;0EAAQ,IAAI,WAAW;;;;;;;;;;;;kEAElC,8OAAC;;4DAAE;0EACU,8OAAC;0EAAQ,IAAI,KAAK,IAAI,SAAS,EAAE,cAAc;;;;;;;;;;;;oDAE3D,IAAI,gBAAgB,kBACnB,8OAAC;;4DAAE;0EACY,8OAAC;0EAAQ,IAAI,gBAAgB;;;;;;;;;;;;;;;;;;;uCAjBxC,IAAI,MAAM;;;;;;;;;;;sCA0BxB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;8CAAG;;;;;;gCACH,iBAAiB,GAAG,CAAC,CAAC,wBACrB,8OAAC;wCAA8B,WAAU;;0DACvC,8OAAC;gDACC,KAAK,CAAC,mBAAmB,CAAC;gDAC1B,WAAU;;;;;;0DAEZ,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;;4DAAE;0EACa,8OAAC;0EAAQ,QAAQ,YAAY;;;;;;;;;;;;kEAE7C,8OAAC;;4DAAE;0EACU,8OAAC;0EAAQ,QAAQ,kBAAkB;;;;;;;;;;;;kEAEhD,8OAAC;;4DAAE;0EACY,8OAAC;0EAAQ,IAAI,KAAK,QAAQ,WAAW,EAAE,cAAc;;;;;;;;;;;;;;;;;;;uCAb9D,QAAQ,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuB3C;uCAEe"}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}