{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/src/app/newhome/addContents/page.tsx"],"sourcesContent":["'use client';\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useRouter, useSearchParams } from 'next/navigation'; \r\nimport './page.css';\r\n\r\nconst AddContentsPage = () => {\r\n  const [files, setFiles] = useState<File[]>([]); // Store files\r\n  const [error, setError] = useState(\"\");\r\n  const [username, setUsername] = useState<string | null>(null); \r\n  const router = useRouter(); \r\n  const searchParams = useSearchParams();\r\n\r\n  const capsuleName = searchParams.get('capsuleName') || '';\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== \"undefined\") {\r\n      const storedUser  = localStorage.getItem('user');\r\n      const storedUsername = storedUser  ? JSON.parse(storedUser ).username : null;\r\n      setUsername(storedUsername); \r\n\r\n      if (!storedUsername) {\r\n        setError(\"User  is not logged in. Please log in to continue.\");\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    if (e.target.files) {\r\n      const selectedFiles = Array.from(e.target.files);\r\n      const validFiles = selectedFiles.filter(file => file.type.startsWith('image/')); // Filter for image files\r\n      setFiles(validFiles); // Update state with valid image files\r\n      if (validFiles.length === 0) {\r\n        setError(\"Please upload at least one image file.\");\r\n      } else {\r\n        setError(\"\"); // Clear error if valid files are selected\r\n      }\r\n    }\r\n  };\r\n\r\n  const validateForm = () => {\r\n    if (files.length === 0) {\r\n      setError(\"Please upload at least one image file.\");\r\n      return false;\r\n    }\r\n    if (!capsuleName) {\r\n      setError(\"Capsule name is required.\");\r\n      return false;\r\n    }\r\n    if (!username) {\r\n      setError(\"User  is not logged in.\");\r\n      return false;\r\n    }\r\n    setError(\"\");\r\n    return true;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n  \r\n    if (validateForm()) {\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"capsule_name\", capsuleName);\r\n        formData.append(\"username\", username || \"\");\r\n  \r\n        // Append only one image file\r\n        if (files.length > 0) {\r\n          formData.append(\"content\", files[0]); // Only append the first image file\r\n        }\r\n  \r\n        const response = await fetch(\"/api/addContents\", {\r\n          method: \"POST\",\r\n          body: formData,\r\n        });\r\n  \r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          const capsuleId = data.capsule_id;\r\n          alert(\"Image content added successfully to the Time Capsule!\");\r\n          router.push(`/newhome/addSharedUsers?capsuleId=${capsuleId}`);\r\n        } else {\r\n          const errorData = await response.json();\r\n          setError(errorData.error || \"Failed to save content. Please try again.\");\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error submitting content\", error);\r\n        setError(\"An error occurred while saving the content.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"form-container\">\r\n      <h2>Page 2: Add Contents</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <label>\r\n          Upload Images:\r\n          <input type=\"file\" accept=\"image/*\" onChange={handleFileChange} />\r\n          {files.length > 0 && (\r\n            <ul>\r\n              {files.map((file, index) => (\r\n                <li key={index}>{file.name}</li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </label>\r\n\r\n        {error && <p className=\"error\">{error}</p>}\r\n        <button type=\"submit\">Submit</button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddContentsPage;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO"}},
    {"offset": {"line": 192, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}